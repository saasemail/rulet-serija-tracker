<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pametne Kolone – Rulet Tracker</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f8f9fa; }
    input, button { font-size: 1.2em; padding: 8px; margin: 5px; }
    #history { margin-top: 10px; font-size: 1.1em; }
    .bold { font-weight: bold; color: #222; }
    #output { font-size: 1.5em; margin-top: 15px; }
  </style>
</head>
<body>
  <h2>Pametne Kolone – Rulet Tracker</h2>
  <label for="newNumber">Unesi novi broj (1–36):</label><br>
  <input type="number" id="newNumber" min="1" max="36">
  <button onclick="addNumber()">Unesi</button>
  <button onclick="analyze()">Analiziraj</button>

  <div id="history" class="bold">Uneti brojevi: </div>
  <div id="output"></div>

  <script>
    const numbers = []

    function addNumber() {
      const input = document.getElementById("newNumber")
      const num = parseInt(input.value)
      if (!isNaN(num) && num >= 1 && num <= 36) {
        numbers.unshift(num) // novi broj ide levo
        input.value = ""
        updateHistory()
      }
    }

    function updateHistory() {
      document.getElementById("history").innerText = "Uneti brojevi: " + numbers.join(", ")
    }

    function getColumn(num) {
      if (num >= 1 && num <= 12) return 1
      if (num >= 13 && num <= 24) return 2
      if (num >= 25 && num <= 36) return 3
      return 0
    }

    function analyze() {
      const output = document.getElementById("output")
      if (numbers.length < 10) {
        output.innerText = "Unesi bar 10 brojeva za analizu."
        return
      }

      const skipMap = {1: 0, 2: 0, 3: 0}
      const patternMap = {1: [], 2: [], 3: []}

      // Napuni istoriju kolona
      const columnHistory = numbers.map(getColumn)

      // Traži koliko puta su kolone bile preskočene 3x i onda pogodile
      for (let i = 3; i < columnHistory.length - 1; i++) {
        for (let c = 1; c <= 3; c++) {
          if (
            columnHistory[i] !== c &&
            columnHistory[i - 1] !== c &&
            columnHistory[i - 2] !== c &&
            columnHistory[i + 1] === c
          ) {
            patternMap[c].push(true)
          } else if (
            columnHistory[i] !== c &&
            columnHistory[i - 1] !== c &&
            columnHistory[i - 2] !== c
          ) {
            patternMap[c].push(false)
          }
        }
      }

      let bestCol = null
      let bestRatio = 0

      for (let c = 1; c <= 3; c++) {
        const total = patternMap[c].length
        const hits = patternMap[c].filter(x => x).length
        const ratio = total > 0 ? hits / total : 0

        if (ratio >= 0.6) {
          const last3 = columnHistory.slice(0, 3)
          if (!last3.includes(c)) {
            if (ratio > bestRatio) {
              bestRatio = ratio
              bestCol = c
            }
          }
        }
      }

      if (bestCol) {
        let name = bestCol === 1 ? "PRVA" : bestCol === 2 ? "SREDNJA" : "VELIKA"
        output.innerText = `✅ KRENI: ${name} KOLONA`
      } else {
        output.innerText = "❌ NEMA SIGURNOG ULAZA"
      }
    }
  </script>
</body>
</html>
