<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rulet Serija Tracker ‚Äì Prediktivni Mod</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2rem; background: #f0f0f0; }
    h1 { text-align: center; }
    #history { display: flex; flex-direction: row; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
    .ball { padding: 8px 12px; border-radius: 20px; background: #ddd; }
    .red { background: crimson; color: white; }
    .black { background: black; color: white; }
    .green { background: green; color: white; }
    button { margin-top: 10px; padding: 10px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Rulet Serija Tracker ‚Äì Prediktivni Mod üéØ</h1>

  <label for="initialNumbers">Poƒçetni brojevi (najnoviji levo kao u kazinu):</label>
  <div id="history"></div>

  <input type="number" id="newNumber" placeholder="Novi broj" />
  <button onclick="analyze()">Analiziraj</button>
  <button onclick="markDealerChange()">Reset Krupije</button>
  <p id="result"></p>

  <script>
    let fullHistory = [];
    let ignoreNext = 0;

    const colorMap = {
      green: [0],
      red: [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36],
      black: [2,4,6,8,10,11,13,15,17,20,22,24,26,28,29,31,33,35]
    };

    function getColor(n) {
      if (colorMap.red.includes(n)) return 'red';
      if (colorMap.black.includes(n)) return 'black';
      return 'green';
    }

    function markDealerChange() {
      ignoreNext = 5; // ignorisi sledecih 5 brojeva u analizi
    }

    function updateDisplay() {
      const historyDiv = document.getElementById("history");
      historyDiv.innerHTML = '';
      fullHistory.forEach(n => {
        const ball = document.createElement('div');
        ball.className = `ball ${getColor(n)}`;
        ball.innerText = n;
        historyDiv.appendChild(ball);
      });
    }

    document.getElementById("newNumber").addEventListener("keyup", function (e) {
      if (e.key === "Enter") {
        const val = parseInt(e.target.value);
        if (!isNaN(val) && val >= 0 && val <= 36) {
          fullHistory.unshift(val); // novi ide prvi levo
          if (fullHistory.length > 200) fullHistory.pop();
          updateDisplay();
          e.target.value = '';
        }
      }
    });

    function analyze() {
      const result = document.getElementById("result");
      result.innerText = "";

      if (fullHistory.length < 15 + ignoreNext) {
        result.innerText = "Nema dovoljno podataka za analizu.";
        return;
      }

      const patternLength = 5;
      const recentPattern = fullHistory.slice(ignoreNext, ignoreNext + patternLength).map(getColor).join('-');

      let matchCount = 0;
      let successCount = 0;

      for (let i = ignoreNext + 5; i < fullHistory.length - patternLength - 2; i++) {
        const sample = fullHistory.slice(i, i + patternLength).map(getColor).join('-');
        const after = fullHistory.slice(i + patternLength, i + patternLength + 3).map(getColor);

        if (sample === recentPattern) {
          matchCount++;
          if (after[0] === after[1] && after[1] === after[2]) {
            successCount++;
          }
        }
      }

      if (matchCount >= 3 && successCount >= 3) {
        const nextColor = getColor(fullHistory[ignoreNext]);
        result.innerText = `‚úÖ KRENI ${nextColor.toUpperCase()} (Pogodaka: ${successCount}/${matchCount})`;
      } else {
        result.innerText = "‚ùå Nema signala";
      }
    }
  </script>
</body>
</html>
